<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quantum Simulation on Noisy Superconducting Quantum Computers &#8212; Qiskit Research 0.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fd506691" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=c1dcd045"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Qiskit Research API Reference" href="../apidocs/index.html" />
    <link rel="prev" title="Tutorial on quantum simulation" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Quantum-Simulation-on-Noisy-Superconducting-Quantum-Computers">
<h1>Quantum Simulation on Noisy Superconducting Quantum Computers<a class="headerlink" href="#Quantum-Simulation-on-Noisy-Superconducting-Quantum-Computers" title="Permalink to this heading">¶</a></h1>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this heading">¶</a></h2>
<p>This notebook is a companion to our paper [1] on quantum simulation. This notebook is not written as a research paper nor is it an introductory level tutorial; the context for some techniques will be missing as well as rigorous theoretical explanations. (These can be found in the paper [1] and subsequent citations.) Instead, this notebook aims to demonstrate minimal working examples of state-of-the-art techniques using Qiskit with the intent for you to build upon them. We demonstrate the time
evolution of a simple tight binding model and various error mitigation techniques. Note that this tight-binding model can be solved exactly because it is a quadratic fermionic Hamiltonian, but we will be Trotterizing it for expository purposes. We hope you find the source code useful to jump start your own quantum research into more complicated models and methods.</p>
<p>We would love to see how you build on these ideas and methods for your own work!</p>
<p><a class="reference external" href="https://arxiv.org/abs/2209.02795">[1]</a> “Quantum Simulation on Noisy Quantum Computers”, Kaelyn J. Ferris, A.J. Rasmusson, Nicholas T. Bronn, Olivia Lanes. <a class="reference external" href="https://arxiv.org/abs/2209.02795">arXiv:2209.02795 [quant-ph]</a> (2022)</p>
</section>
<section id="The-Tight-Binding-Model">
<h2>The Tight Binding Model<a class="headerlink" href="#The-Tight-Binding-Model" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Tight_binding">tight-binding model</a> is an exemplary model for physical systems with tightly bound particles. For example, physical systems where electrons are tightly bond to nuclei can be approximated by a tight binding model. It is also apart of other, more complicated, models, which we briefly discuss in the <a class="reference external" href="https://arxiv.org/abs/2209.02795">paper</a>. This makes it a nice minimal example, because it can be added upon in various ways to model many other
types of systems.</p>
<p>In this specific example, we’ll consider the case of a single particle that can “hop” between 5 lattice sites. There is a “hopping strength” <span class="math notranslate nohighlight">\(\tau\)</span> to hop between different binding sites. We ignore any spin degree of freedom to the particle. We include a defect in the way of a hopping term that has a different value <span class="math notranslate nohighlight">\(\tau_d\)</span>. The particle will initially start on the left most site of the lattice. <strong>Our goal is to measure the state dynamics of the particle.</strong></p>
<p>The tight binding model (ignoring spin and no defect) follows the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[H = -\tau \sum_{\langle i, j\rangle}^{N} \left( c_{i}^{\dagger} c_{j} + c_{j}^{\dagger} c_{i} \right) \;.\]</div>
<p>Let’s consider a 1D chain of 5 sites. The Hamiltonian is then</p>
<div class="math notranslate nohighlight">
\[\begin{align}
H &amp;= -\tau \sum_{i=0}^{3} \left( c_{i}^{\dagger} c_{i+1} + c_{i+1}^{\dagger} c_{i} \right) \;.
\end{align}\]</div>
<p>Now, let’s include the defect hopping term in the lattice, and set the values <span class="math notranslate nohighlight">\(\tau = 1\)</span> and <span class="math notranslate nohighlight">\(\tau_d = 0.5\)</span> with <span class="math notranslate nohighlight">\(\tau_d\)</span> between sites 2 and 3.</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
H = -\tau \sum_{i=(0,1,3)} \left( c_{i}^{\dagger} c_{i+1} + c_{i+1}^{\dagger} c_{i} \right) - \tau_d \left( c_{2}^{\dagger} c_{3} + c_{3}^{\dagger} c_{2} \right) \;.
\end{equation}\]</div>
<p>See the <a class="reference external" href="https://arxiv.org/abs/2209.02795">paper</a> for full details.</p>
<p><img alt="img" src="../_images/lattice.png" /></p>
<section id="Transformation-to-Pauli-Operators">
<h3>Transformation to Pauli Operators<a class="headerlink" href="#Transformation-to-Pauli-Operators" title="Permalink to this heading">¶</a></h3>
<p>We transform the fermionic Hamiltonian to a spin Hamiltonian, so it can be simulated on a quantum computer. (See the <a class="reference external" href="https://arxiv.org/abs/2209.02795">paper</a> and literature references for more details.)</p>
<p>In mapping annihilation and creation operators to Pauli operators (labeled <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span>, <span class="math notranslate nohighlight">\(Z\)</span>, and the identity as <span class="math notranslate nohighlight">\(I\)</span>), we are mapping whether a site is occupied or not. Remember that we are ignoring any spin degree of freedom.</p>
</section>
<section id="Creation-and-Annihilation-Operators">
<h3>Creation and Annihilation Operators<a class="headerlink" href="#Creation-and-Annihilation-Operators" title="Permalink to this heading">¶</a></h3>
<p>The action of the creation operator on the vacuum state “creates” or “raises” the state <span class="math notranslate nohighlight">\(c^{\dagger}|0\rangle = |1\rangle\)</span>. Action of the annihilation operator on the vacuum “annihilates” or “lowers” the state to zero <span class="math notranslate nohighlight">\(c|1\rangle = |0\rangle\)</span>. Following the Jordan-Wigner transformation (but making adjustments to ignore the spin of the particle), the creation <span class="math notranslate nohighlight">\(c^{\dagger}\)</span> and annihilation <span class="math notranslate nohighlight">\(c\)</span> operators map to Pauli raising <span class="math notranslate nohighlight">\(\sigma_+\)</span> and lowering <span class="math notranslate nohighlight">\(\sigma_-\)</span>
operators.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
c^{\dagger}_i &amp;= \sigma_{+} = Z_0 \dots Z_{i-1} \left( \dfrac{X_i - i Y_i}{2} \right) I_{i+1} \dots I_N \\
c_i &amp;= \sigma_{-} = Z_0 \dots Z_{i-1} \left( \dfrac{X_i + i Y_i}{2} \right) I_{i+1} \dots I_N
\end{align}\end{split}\]</div>
<p>Note that these definitions are typically switched when working in the spin-1/2 basis.</p>
<p>Applying the transformation, and including the defect between sites 2 and 3 (as described in the paper), the Hamiltonian becomes</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
H = -\frac{\tau}{2} \sum_{i=(0,1,3)} \left( X_i X_{i+1} + Y_i Y_{i+1} \right) -\frac{\tau_d}{2} \left( X_2 X_{3} + Y_2 Y_{3} \right)
\end{equation}\]</div>
<p>We’re now ready to write this Hamiltonian in Qiskit.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span> <span class="nn">qiskit.converters</span> <span class="kn">import</span> <span class="n">circuit_to_dag</span><span class="p">,</span> <span class="n">dag_to_circuit</span>
<span class="kn">from</span> <span class="nn">qiskit.dagcircuit</span> <span class="kn">import</span> <span class="n">DAGCircuit</span><span class="p">,</span> <span class="n">DAGNode</span><span class="p">,</span> <span class="n">DAGOpNode</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>  <span class="c1"># enlarge matplotlib fonts</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">Zero</span><span class="p">,</span> <span class="n">One</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">Parameter</span>
</pre></div>
</div>
</div>
<p><strong>Qiskit nature method.</strong> If we want to start from fermionic operator form of the Hamiltonian <span class="math notranslate nohighlight">\(H = -\tau \sum_{i=(0,1,3)} \left( c_{i}^{\dagger} c_{i+1} + c_{i+1}^{\dagger} c_{i} \right) - \tau_d \left( c_{2}^{\dagger} c_{3} + c_{3}^{\dagger} c_{2} \right) \;,\)</span> we can use functionality from <a class="reference external" href="https://qiskit.org/documentation/nature/">Qiskit nature</a> to define the Hamiltonian in terms of fermionic second quantization operators and have qiskit do the Jordan-Wigner transformation to Pauli
operators. This is shown below but not currently used in the notebook as FermionicOp does not currently support <a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.circuit.Parameter.html">Parameters</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit_nature.operators.second_quantization</span> <span class="kn">import</span> <span class="n">FermionicOp</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.mappers.second_quantization</span> <span class="kn">import</span> <span class="n">JordanWignerMapper</span>


<span class="c1"># TODO: update once FermionicOp supports Parameters. See Github Issue: https://github.com/Qiskit/qiskit-nature/issues/828</span>
<span class="k">def</span> <span class="nf">compute_H_secondquant</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau_d</span><span class="p">,</span> <span class="n">num_sites</span><span class="p">,</span> <span class="n">defect_locs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute 1D spinless tight-binding Hamiltonian with &quot;defective&quot; interactions on specificed edges by first</span>
<span class="sd">        defining the system with a FermionicOp object followed by a JordanWigner transform.</span>

<span class="sd">    Args:</span>
<span class="sd">        tau - float; strength of hopping term between all sites except at the defect edge(s)</span>
<span class="sd">        tau_d - float; strength of hopping term at defect edge(s)</span>
<span class="sd">        num_sites - int; number of lattice sites in the 1D chain</span>
<span class="sd">        defect_locs - list or array of ints; index location(s) of defect edge(s). Indexed such that the left most edge is at position 0 and the rightmost is 4</span>

<span class="sd">    Returns:</span>
<span class="sd">        pauli_H - PauliSumOp; the Hamiltonian in Pauli operators</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">second_quant_H</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sites</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">defect_locs</span><span class="p">:</span>
            <span class="n">second_quant_H</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">FermionicOp</span><span class="p">(</span><span class="s2">&quot;+_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span><span class="p">))</span> <span class="o">@</span> <span class="n">FermionicOp</span><span class="p">(</span><span class="s2">&quot;-_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="o">+</span> <span class="n">FermionicOp</span><span class="p">(</span><span class="s2">&quot;+_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="o">@</span> <span class="n">FermionicOp</span><span class="p">(</span><span class="s2">&quot;-_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span><span class="p">))</span>
            <span class="p">)</span> <span class="o">*</span> <span class="n">tau_d</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">second_quant_H</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">FermionicOp</span><span class="p">(</span><span class="s2">&quot;+_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span><span class="p">))</span> <span class="o">@</span> <span class="n">FermionicOp</span><span class="p">(</span><span class="s2">&quot;-_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="o">+</span> <span class="n">FermionicOp</span><span class="p">(</span><span class="s2">&quot;+_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="o">@</span> <span class="n">FermionicOp</span><span class="p">(</span><span class="s2">&quot;-_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span><span class="p">))</span>
            <span class="p">)</span> <span class="o">*</span> <span class="n">tau</span>
    <span class="c1"># Transform to Pauli Operators</span>
    <span class="n">jw_mapper</span> <span class="o">=</span> <span class="n">JordanWignerMapper</span>
    <span class="n">pauli_H</span> <span class="o">=</span> <span class="n">JordanWignerMapper</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">jw_mapper</span><span class="p">,</span> <span class="n">second_quant_H</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pauli_H</span>


<span class="c1"># Example computation</span>
<span class="n">compute_H_secondquant</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PauliSumOp(SparsePauliOp([&#39;IIIYY&#39;, &#39;IIIXX&#39;, &#39;IIYYI&#39;, &#39;IIXXI&#39;, &#39;IYYII&#39;, &#39;IXXII&#39;, &#39;YYIII&#39;, &#39;XXIII&#39;],
              coeffs=[-0.5 +0.j, -0.5 +0.j, -0.5 +0.j, -0.5 +0.j, -0.25+0.j, -0.25+0.j,
 -0.5 +0.j, -0.5 +0.j]), coeff=1.0)
</pre></div></div>
</div>
<p><strong>Qiskit Opflow method.</strong> If we want to start directly with the Pauli operator form of the Hamiltonian (doing the JW transform with “pen and paper”) <span class="math notranslate nohighlight">\(H = -\frac{\tau}{2} \sum_{i=(0,1,3)} \left( X_i X_{i+1} + Y_i Y_{i+1} \right) -\frac{\tau_d}{2} \left( X_2 X_{3} + Y_2 Y_{3} \right) \;,\)</span> then we directly use <a class="reference external" href="https://qiskit.org/documentation/apidoc/opflow.html">Qiskit opflow</a>’s Pauli operators to string together the Hamiltonian terms. This is shown below and will be the method called
later in the notebook as this method supports <a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.circuit.Parameter.html">Parameters</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_H</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau_d</span><span class="p">,</span> <span class="n">num_sites</span><span class="p">,</span> <span class="n">defect_locs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute 1D spinless tight-binding Hamiltonian with &quot;defective&quot; interactions on specificed edges</span>

<span class="sd">    Args:</span>
<span class="sd">        tau - float; strength of hopping term between all sites except at the defect edge(s)</span>
<span class="sd">        tau_d - float; strength of hopping term at defect edge(s)</span>
<span class="sd">        num_sites - int; number of lattice sites in the 1D chain</span>
<span class="sd">        defect_locs - list or array of ints; index location(s) of defect edge(s). Indexed such that the left most edge is at position 0 and the rightmost is 4</span>

<span class="sd">    Returns:</span>
<span class="sd">        H - SummedOp; the Hamiltonian</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">H</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sites</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">defect_locs</span><span class="p">:</span>
            <span class="n">H</span> <span class="o">+=</span> <span class="o">-</span><span class="n">tau_d</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">I</span> <span class="o">^</span> <span class="p">(</span><span class="n">num_sites</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">X</span> <span class="o">^</span> <span class="n">X</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">I</span> <span class="o">^</span> <span class="n">i</span><span class="p">))</span>
            <span class="n">H</span> <span class="o">+=</span> <span class="o">-</span><span class="n">tau_d</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">I</span> <span class="o">^</span> <span class="p">(</span><span class="n">num_sites</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">Y</span> <span class="o">^</span> <span class="n">Y</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">I</span> <span class="o">^</span> <span class="n">i</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H</span> <span class="o">+=</span> <span class="o">-</span><span class="n">tau</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">I</span> <span class="o">^</span> <span class="p">(</span><span class="n">num_sites</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">X</span> <span class="o">^</span> <span class="n">X</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">I</span> <span class="o">^</span> <span class="n">i</span><span class="p">))</span>
            <span class="n">H</span> <span class="o">+=</span> <span class="o">-</span><span class="n">tau</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">I</span> <span class="o">^</span> <span class="p">(</span><span class="n">num_sites</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">Y</span> <span class="o">^</span> <span class="n">Y</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">I</span> <span class="o">^</span> <span class="n">i</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">H</span>


<span class="c1"># Example computation. This Hamiltonian is the same model we cover in the paper and will persist through the notebook.</span>
<span class="n">num_sites</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">defect_location</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Parameterized hopping strengths</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;τ&quot;</span><span class="p">)</span>
<span class="n">tau_d</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;τ_d&quot;</span><span class="p">)</span>
<span class="n">H_param</span> <span class="o">=</span> <span class="n">compute_H</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">tau_d</span><span class="p">,</span> <span class="n">num_sites</span><span class="p">,</span> <span class="n">defect_location</span><span class="p">)</span>

<span class="c1"># Select specific tau and tau_d values</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">H_param</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">tau</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tau_d</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>

<span class="c1"># Print Hamiltonian operators to confirm it&#39;s what we expect</span>
<span class="n">H</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SummedOp([PauliOp(Pauli(&#39;IIIXX&#39;), coeff=-0.5), PauliOp(Pauli(&#39;IIIYY&#39;), coeff=-0.5), PauliOp(Pauli(&#39;IIXXI&#39;), coeff=-0.5), PauliOp(Pauli(&#39;IIYYI&#39;), coeff=-0.5), PauliOp(Pauli(&#39;IXXII&#39;), coeff=-0.25), PauliOp(Pauli(&#39;IYYII&#39;), coeff=-0.25), PauliOp(Pauli(&#39;XXIII&#39;), coeff=-0.5), PauliOp(Pauli(&#39;YYIII&#39;), coeff=-0.5)], coeff=1.0, abelian=False)
</pre></div></div>
</div>
<p>With the Hamiltonian, we can now construct its associated time evolution operator.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time evolution operator for a Hamiltonian H and time time_param</span>
<span class="k">def</span> <span class="nf">compute_U</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the time evolution operator.</span>

<span class="sd">    Args:</span>
<span class="sd">        H - OperatorBase (such as SummedOp); the Hamiltonan under which you wish to time evolve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        U - EvolvedOp; The time evolution operator parameterized by variable &#39;t&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">U</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">exp_i</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">U</span>


<span class="c1"># Print example output</span>
<span class="n">time_param</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">compute_U</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
EvolvedOp(SummedOp([PauliOp(Pauli(&#39;IIIXX&#39;), coeff=-0.5), PauliOp(Pauli(&#39;IIIYY&#39;), coeff=-0.5), PauliOp(Pauli(&#39;IIXXI&#39;), coeff=-0.5), PauliOp(Pauli(&#39;IIYYI&#39;), coeff=-0.5), PauliOp(Pauli(&#39;IXXII&#39;), coeff=-0.25), PauliOp(Pauli(&#39;IYYII&#39;), coeff=-0.25), PauliOp(Pauli(&#39;XXIII&#39;), coeff=-0.5), PauliOp(Pauli(&#39;YYIII&#39;), coeff=-0.5)], coeff=1.0*t, abelian=False), coeff=1.0)
</pre></div></div>
</div>
<p>The observables we are interested in are the expectation values of the number operators <span class="math notranslate nohighlight">\(\langle n_i(t)\rangle\)</span> at a given site <span class="math notranslate nohighlight">\(i\)</span> after an evolution time <span class="math notranslate nohighlight">\(t\)</span>. In the case of a single particle, the number operator <span class="math notranslate nohighlight">\(\langle n_i(t)\rangle\)</span> is the probability of the particle to occupy site <span class="math notranslate nohighlight">\(i\)</span>. Using the same JW transformation we used on the Hamiltonian, <span class="math notranslate nohighlight">\(\langle n_i(t)\rangle\)</span> in terms of Pauli operators is</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
n_i = c^{\dagger}_i c_i = \left(\dfrac{X_i - i Y_i}{2} \right) \left(\dfrac{X_i + i Y_i}{2}\right) = \left(\mathbb{1} - Z_i\right) / 2
\end{equation}\]</div>
<p>We can construct these using Qiskit opflow as well.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a list of number operators in terms of Pauli operators</span>
<span class="n">n_is</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">I</span> <span class="o">^</span> <span class="n">num_sites</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">I</span> <span class="o">^</span> <span class="n">i</span><span class="p">)</span> <span class="o">^</span> <span class="n">Z</span> <span class="o">^</span> <span class="p">(</span><span class="n">I</span> <span class="o">^</span> <span class="p">(</span><span class="n">num_sites</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sites</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">n_is</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[PauliSumOp(SparsePauliOp([&#39;IIIII&#39;, &#39;ZIIII&#39;],
               coeffs=[ 0.5+0.j, -0.5+0.j]), coeff=1.0),
 PauliSumOp(SparsePauliOp([&#39;IIIII&#39;, &#39;IZIII&#39;],
               coeffs=[ 0.5+0.j, -0.5+0.j]), coeff=1.0),
 PauliSumOp(SparsePauliOp([&#39;IIIII&#39;, &#39;IIZII&#39;],
               coeffs=[ 0.5+0.j, -0.5+0.j]), coeff=1.0),
 PauliSumOp(SparsePauliOp([&#39;IIIII&#39;, &#39;IIIZI&#39;],
               coeffs=[ 0.5+0.j, -0.5+0.j]), coeff=1.0),
 PauliSumOp(SparsePauliOp([&#39;IIIII&#39;, &#39;IIIIZ&#39;],
               coeffs=[ 0.5+0.j, -0.5+0.j]), coeff=1.0)]
</pre></div></div>
</div>
</section>
<section id="Classical-Simulation">
<h3>Classical Simulation<a class="headerlink" href="#Classical-Simulation" title="Permalink to this heading">¶</a></h3>
<p>We can now classically simulate the state evolution and measure the observables of interest.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculation of each number operator&#39;s expectation value over time</span>

<span class="c1"># Initial state on the far left of the 1D lattice</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">One</span> <span class="o">^</span> <span class="n">Zero</span> <span class="o">^</span> <span class="n">Zero</span> <span class="o">^</span> <span class="n">Zero</span> <span class="o">^</span> <span class="n">Zero</span>
<span class="c1"># Define array of time points (technically these are relative to the hopping terms)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Calculation each number operator&#39;s expectation value at each time point</span>
<span class="c1"># Initialize a 2D array which we will fill with each site&#39;s expectation value (columns) and at each time point (rows)</span>
<span class="n">evo_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">num_sites</span><span class="p">))</span>
<span class="c1"># Initialize 1D array to fill in variance of the sum of the number operators</span>
<span class="n">var_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">times</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">ni</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_is</span><span class="p">):</span>
        <span class="c1"># Compute the time evolution operator U(time) at time time</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">compute_U</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">)</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">time_param</span><span class="p">:</span> <span class="n">time</span><span class="p">})</span>
        <span class="c1"># Compute the evolution of the initial state</span>
        <span class="n">final_state</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">initial_state</span>
        <span class="c1"># Compute the expectation value n_i</span>
        <span class="n">evo_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">final_state</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="o">@</span> <span class="n">ni</span> <span class="o">@</span> <span class="n">final_state</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
    <span class="n">var_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">final_state</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="o">@</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">n_is</span><span class="p">)</span> <span class="o">@</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n_is</span><span class="p">))</span> <span class="o">@</span> <span class="n">final_state</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
        <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">final_state</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="o">@</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n_is</span><span class="p">)</span> <span class="o">@</span> <span class="n">final_state</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 50/50 [00:03&lt;00:00, 13.92it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the time evolution</span>
<span class="c1"># list of labels for the plot</span>
<span class="n">num_op_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$\langle n_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">rangle$&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sites</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">evo_matrix</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Probability of occupying a given site&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">num_op_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_15_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_15_0.png" />
</div>
</div>
<p>Let’s try another kind of plot to get a sense for how the particle moves across the lattice over time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">evo_matrix</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma_r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_sites</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_sites</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">evo_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">8</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Site index&quot;</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Wavepacket evolution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_17_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_17_0.png" />
</div>
</div>
<section id="Particle-conservation-check">
<h4>Particle conservation check<a class="headerlink" href="#Particle-conservation-check" title="Permalink to this heading">¶</a></h4>
<p>It’s always a good idea to test if a computer is giving something that makes sense. One such test, and a rather low effort one, is to compute the probability of finding the particle across all sites at each time point. Since we know there is only one particle to begin with and particle number is conserved, we should calculate 1 for all time steps. We will later use this fact in post-processing our quantum computer data by throwing out any measurements that don’t preserve particle number.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check that at each time point, the total number of particles is constant</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">evo_matrix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;total number of particles&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Particle conservation check&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_19_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_19_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confirm the variance of the number of particles is zero to confirm particle number conservation.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">var_matrix</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;variance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Particle conservation check&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_20_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_20_0.png" />
</div>
</div>
</section>
</section>
<section id="Trotterization">
<h3>Trotterization<a class="headerlink" href="#Trotterization" title="Permalink to this heading">¶</a></h3>
<p>To simulate these state dynamics on a quantum computer, we’ve chosen to use the Trotter-Suzuki decomposition of the time evolution. Remember that this tight-binding model can be solved exactly because it is a quadratic fermionic Hamiltonian, but here, we will use it to illustrate the Trotter-Suzuki decomposition and subsequent techniques. This is covered more thoroughly in the <a class="reference external" href="https://arxiv.org/abs/2209.02795">paper</a> and the references therein.</p>
<p>Trotterization of defect free Hamiltonian. (Defect version shown later on.)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
H &amp;= -\frac{t}{2} \sum_{i=0}^{3} \left( X_i X_{i+1} + Y_i Y_{i+1} \right) \\
H &amp;= -\frac{t}{2}\left(X_0 X_1 + Y_0 Y_1 + X_1 X_2 + Y_1 Y_2 + X_2 X_3 + Y_2 Y_3 + X_3 X_4 + Y_3 Y_4 \right) \\
\end{align}\end{split}\]</div>
<p>The time evolution is then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
U(\tau) &amp;= \exp \left[i\frac{\tau t}{2}\left(X_0 X_1 + Y_0 Y_1 + X_1 X_2 + Y_1 Y_2 + X_2 X_3 + Y_2 Y_3 + X_3 X_4 + Y_3 Y_4 \right) \right] \\
U(\tau) &amp;\approx \prod_{n=0}^N \exp \left[i\frac{\tau t}{2n}\left(X_0 X_1 + Y_0 Y_1\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(X_1 X_2 + Y_1 Y_2 \right) \right]^n \exp \left[i\frac{\tau t}{2n}\left(X_2 X_3 + Y_2 Y_3 \right) \right]^n \exp \left[i\frac{\tau t}{2n}\left(X_3 X_4 + Y_3 Y_4 \right) \right]^n \\
\end{align}\end{split}\]</div>
<p>Including defect</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
U(\tau, \tau_d) \approx \prod_{n=0}^N \exp \left[i\frac{\tau t}{2n}\left(X_0 X_1 + Y_0 Y_1\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(X_1 X_2 + Y_1 Y_2 \right) \right]^n \exp \left[i\frac{\tau_d t}{2n}\left(X_2 X_3 + Y_2 Y_3 \right) \right]^n \exp \left[i\frac{\tau t}{2n}\left(X_3 X_4 + Y_3 Y_4 \right) \right]^n
\end{equation}\]</div>
<p>Each pair of <span class="math notranslate nohighlight">\(XX\)</span> and <span class="math notranslate nohighlight">\(YY\)</span> interactions summed in the exponents do commute, so there could be further decomposition without need of trotterization. There is in fact efficient decompositions for such interactions (see the <a class="reference external" href="https://qiskit.org/documentation/apidoc/circuit_library.html">qiskit circuit library</a>), but we will not go that here. It also depends on the type of gates we can/want to apply at the hardware level. We’ll eventually work toward <span class="math notranslate nohighlight">\(R_{ZX}(\theta)\)</span> gates, so
let’s stay in terms of separating <span class="math notranslate nohighlight">\(XX\)</span> and <span class="math notranslate nohighlight">\(YY\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
U(\tau) &amp;\approx \prod_{n=0}^N \exp \left[i\frac{\tau t}{2n}\left(X_0 X_1\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(Y_0 Y_1\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(X_1 X_2\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(Y_1 Y_2 \right) \right]^n \exp \left[i\frac{\tau t}{2n}\left(X_2 X_3\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(Y_2 Y_3 \right) \right]^n \exp \left[i\frac{\tau t}{2n}\left(X_3 X_4\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(Y_3 Y_4 \right) \right]^n \\
\end{align}\end{split}\]</div>
<p>Including defect is a simple parameter change at the correct operator</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
U(\tau) &amp;\approx \prod_{n=0}^N \exp \left[i\frac{\tau t}{2n}\left(X_0 X_1\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(Y_0 Y_1\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(X_1 X_2\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(Y_1 Y_2 \right) \right]^n \exp \left[i\frac{\tau_d t}{2n}\left(X_2 X_3\right)\right]^n \exp \left[i\frac{\tau_d t}{2n}\left(Y_2 Y_3 \right) \right]^n \exp \left[i\frac{\tau t}{2n}\left(X_3 X_4\right)\right]^n \exp \left[i\frac{\tau t}{2n}\left(Y_3 Y_4 \right) \right]^n \\
\end{align}\end{split}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">Suzuki</span>


<span class="k">def</span> <span class="nf">compute_U_trot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the Suzuki-Trotter approximation to the Hamiltonian H to compute a trotterized unitary time evolution operator.</span>

<span class="sd">    Args:</span>
<span class="sd">        H - OperatorBase (such as SummedOp); Hamiltonian governing time dynamics.</span>
<span class="sd">        time - float or Parameter; time of evolution under Hamtilonian H.</span>
<span class="sd">        tortter_steps - int; number of trotter_steps.</span>
<span class="sd">        order - int; order of Suzuki-Trotterization approximation to use when approximating H.</span>

<span class="sd">    Returns:</span>
<span class="sd">        U_trot - ComposeOp; The Trotterized time evolution operator</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">U_trot</span> <span class="o">=</span> <span class="n">Suzuki</span><span class="p">(</span><span class="n">trotter_steps</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">time</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">U_trot</span>


<span class="c1"># Print example output</span>
<span class="n">compute_U_trot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ComposedOp([EvolvedOp(PauliOp(Pauli(&#39;IIIXX&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IIIYY&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IIXXI&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IIYYI&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IXXII&#39;), coeff=-0.125), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IYYII&#39;), coeff=-0.125), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;XXIII&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;YYIII&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IIIXX&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IIIYY&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IIXXI&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IIYYI&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IXXII&#39;), coeff=-0.125), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;IYYII&#39;), coeff=-0.125), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;XXIII&#39;), coeff=-0.25), coeff=1.0), EvolvedOp(PauliOp(Pauli(&#39;YYIII&#39;), coeff=-0.25), coeff=1.0)], coeff=1.0, abelian=False)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time evolution calculation using same parameters as the exact classical calculation</span>

<span class="c1"># Initial state on the far left (same as before)</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">One</span> <span class="o">^</span> <span class="n">Zero</span> <span class="o">^</span> <span class="n">Zero</span> <span class="o">^</span> <span class="n">Zero</span> <span class="o">^</span> <span class="n">Zero</span>

<span class="c1"># Number of trotter steps</span>
<span class="n">trotter_steps</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># Calculate each number operator&#39;s expectation value at each time point and store in a 2D array</span>
<span class="n">evo_matrix_trot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">num_sites</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ni</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">n_is</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">compute_U_trot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>
        <span class="n">final_state</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">initial_state</span>
        <span class="n">evo_matrix_trot</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
            <span class="p">(</span><span class="n">final_state</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="o">@</span> <span class="n">ni</span> <span class="o">@</span> <span class="n">final_state</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 5/5 [00:13&lt;00:00,  2.62s/it]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">evo_matrix_trot</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma_r&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_sites</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_sites</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">evo_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">8</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Site index&quot;</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Trotterized evolution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_24_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_24_0.png" />
</div>
</div>
<p>The evolution above looks quite similar the exact evolution, but not quite. This is due to trotter error.</p>
</section>
<section id="Trotter-Error">
<h3>Trotter Error<a class="headerlink" href="#Trotter-Error" title="Permalink to this heading">¶</a></h3>
<p>The Suzuki-Trotter approximation is just that: an approximation. To illustrate how this might affect estimating the exact dynamics, let’s plot the evolution of the exact solution with various trotter steps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of trotter steps</span>
<span class="n">trotter_steps</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># Calculate each number operator&#39;s expectation value at each time point</span>
<span class="n">evo_matrix_trot_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">num_sites</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ni</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">n_is</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">compute_U_trot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>
        <span class="n">final_state</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">initial_state</span>
        <span class="n">evo_matrix_trot_5</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
            <span class="p">(</span><span class="n">final_state</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="o">@</span> <span class="n">ni</span> <span class="o">@</span> <span class="n">final_state</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="p">)</span>

<span class="c1"># Number of trotter steps</span>
<span class="n">trotter_steps</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1"># Calculate each number operator&#39;s expectation value at each time point</span>
<span class="n">evo_matrix_trot_8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">num_sites</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ni</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">n_is</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">compute_U_trot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>
        <span class="n">final_state</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">initial_state</span>
        <span class="n">evo_matrix_trot_8</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
            <span class="p">(</span><span class="n">final_state</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="o">@</span> <span class="n">ni</span> <span class="o">@</span> <span class="n">final_state</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 5/5 [00:08&lt;00:00,  1.71s/it]
100%|██████████| 5/5 [00:13&lt;00:00,  2.66s/it]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot state dynamics over one particular site</span>
<span class="n">site</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.25</span><span class="p">,</span> <span class="mf">3.75</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span>
    <span class="n">evo_matrix_trot_5</span><span class="p">[:,</span> <span class="n">site</span><span class="p">],</span>
    <span class="s2">&quot;b-.&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$m=5$&quot;</span><span class="p">,</span>
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;royalblue&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span>
    <span class="n">evo_matrix_trot_8</span><span class="p">[:,</span> <span class="n">site</span><span class="p">],</span>
    <span class="s2">&quot;r--&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$m=8$&quot;</span><span class="p">,</span>
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;salmon&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">evo_matrix</span><span class="p">[:,</span> <span class="n">site</span><span class="p">],</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact&quot;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;State dynamics on site &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">site</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_27_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_27_0.png" />
</div>
</div>
</section>
</section>
<section id="Noisy-Quantum-Computer-Implementation">
<h2>Noisy Quantum Computer Implementation<a class="headerlink" href="#Noisy-Quantum-Computer-Implementation" title="Permalink to this heading">¶</a></h2>
<p>We know what to expect from the quantum computer, so we’re ready for a first-pass implementation! Let’s get started with the usual Qiskit imports, provider access, backends, and backend properties.</p>
<section id="Import-Qiskit,-IBM-credentials,-and-helper-functions">
<h3>Import Qiskit, IBM credentials, and helper functions<a class="headerlink" href="#Import-Qiskit,-IBM-credentials,-and-helper-functions" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">PauliTrotterEvolution</span>

<span class="c1"># Define some useful function used later on in this section</span>


<span class="k">def</span> <span class="nf">convert_U_trot_to_qc</span><span class="p">(</span><span class="n">U_trot</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the U_trot ComposedOp object returned by compute_U_trot() to a bare quantum circuit.</span>

<span class="sd">    Tutorial on using PauliTrotterEvolution at</span>
<span class="sd">    https://qiskit.org/documentation/tutorials/operators/01_operator_flow.html#Part-IV:-Converters</span>

<span class="sd">    Args:</span>
<span class="sd">        U_trot - OperatorBase (such as ComposedOp); Trotterized unitary time evolution operator to be written in terms of a quantum circuit.</span>

<span class="sd">    Returns:</span>
<span class="sd">        qc_trot - QuantumCircuit; The trotterized quantum circuit associated with U_trot. The gates are decomposed down to single and two-qubit gates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">qc_trot</span> <span class="o">=</span> <span class="n">PauliTrotterEvolution</span><span class="p">()</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">U_trot</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">qc_trot</span><span class="o">.</span><span class="n">to_circuit</span><span class="p">()</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
    <span class="p">)</span>  <span class="c1"># add decompose methods so gates are not abstracted unitary blocks</span>


<span class="k">def</span> <span class="nf">gen_trott_qc</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">,</span> <span class="n">q_regs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the full trotter circuit for H with time as an unevaluated Parmaeter.</span>

<span class="sd">    Args:</span>
<span class="sd">        H - ; the Hamiltonain governed the Trotterized time evolution.</span>
<span class="sd">        time_param - ; paramterized time of the evolution. To be evaluated later.</span>
<span class="sd">        trotter_steps - int; number of Trotter steps</span>
<span class="sd">        q_regs - list of ints; the specific qubits of ibm_lagos to be used</span>

<span class="sd">    Returns:</span>
<span class="sd">        qc - QuantumCircuit; trotterized time evolution circuit including measurement gates and set over qubit layout</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialize quantum circuit</span>
    <span class="c1"># working with lagos so we have 7 qubits</span>
    <span class="n">qrs</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
    <span class="c1"># but H only acts no 5 of the 7 qubits in the end, so we only measure 5 qubits in the end</span>
    <span class="n">crs</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">qrs</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>

    <span class="c1"># Prepare initial state |10000&gt; (far left site)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q_regs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Compute unitary time operator</span>
    <span class="n">U_trot_params</span> <span class="o">=</span> <span class="n">compute_U_trot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">trotter_steps</span><span class="p">))</span>
    <span class="c1"># Convert to trotterized unitary to circuit</span>
    <span class="n">qc_trot</span> <span class="o">=</span> <span class="n">convert_U_trot_to_qc</span><span class="p">(</span><span class="n">U_trot_params</span><span class="p">)</span>
    <span class="c1"># Append trotterized circuit to our circuit as a custom gate</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qc_trot</span><span class="p">,</span> <span class="n">q_regs</span><span class="p">)</span>
    <span class="c1"># Add measurements</span>
    <span class="c1"># mapping from quantum registers to classical registers depends on which 5 qubits were selected</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q_regs</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">execute_qcs</span><span class="p">(</span><span class="n">qcs</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute quantum circuits on a bakcend and monitor job. The job id will be displayed</span>

<span class="sd">    Args:</span>
<span class="sd">        qcs - QuantumCircuit or list of QuantumCircuits; These are the quantum circuit/circuits you wish to execute</span>
<span class="sd">        backend - IBMQBackend; the backend that will execute the circuits</span>
<span class="sd">        shots - int; number of repeated measurements</span>
<span class="sd">        verbose - bool; set to true if you want the job id printed</span>

<span class="sd">    Returns:</span>
<span class="sd">        job - IBMQJob; the job associated with the execution of quantum circuits qcs</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Execute QuantumCircuits qcs</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qcs</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Job ID&quot;</span><span class="p">,</span> <span class="n">job</span><span class="o">.</span><span class="n">job_id</span><span class="p">())</span>

    <span class="c1"># Run job monitor to see progress of job</span>
    <span class="n">job_monitor</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">error_message</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">error_message</span><span class="p">())</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">return</span> <span class="n">job</span>


<span class="k">def</span> <span class="nf">dict_to_num_op_ex_val</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">enforce_pc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert counts (or QuasiDistribution) to the expectation value of the number operator at each site.</span>

<span class="sd">    This function can ignore shots that come from states that are not 10000, 01000, 00100, 00010, or 00001 (set enforce_pc=True).</span>
<span class="sd">    All other states would mean more (or less) particles were added (removed) to the system, which violates</span>
<span class="sd">    the particle conservation of the Hamiltonian. Expectation values are renormalized according to which</span>
<span class="sd">    shots obey particle conservation.</span>

<span class="sd">    Args:</span>
<span class="sd">        counts - dict {str: int/float}; dictation of keys with state label bitstrings (e.g. &#39;00001&#39;) with the number of measured instances (int) or probability (float)</span>
<span class="sd">        enforce_pc - bool; if True, only shots from states that preserve single particle conservation (10000, 01000, 00100, 00010, or 00001) will be included in compuation</span>
<span class="sd">        verbose - bool; if True, print out the number of shots included in the computation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        occuptation - 1D array; array of the expectation value of each number operators</span>
<span class="sd">        norm - int/float; number of measurements used in computing the expectation values/probability distribution norm</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize expectation value of the z operator at each site</span>
    <span class="n">z_exp_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_sites</span><span class="p">)</span>
    <span class="c1"># Initialize expectation value of the number operator at each site (i.e. probability of occupying a given site)</span>
    <span class="n">occupation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_sites</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># total number of measurements</span>
    <span class="k">if</span> <span class="n">enforce_pc</span><span class="p">:</span>
        <span class="c1"># Loop through the different measured states for a given time point</span>
        <span class="k">for</span> <span class="n">state_label</span><span class="p">,</span> <span class="n">count_val</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Loop through the individual bits of the state and compute the expectation value of Z at each bit (aka each site)</span>
            <span class="c1"># Only consider state_labels that have a single 1 in the bit-string (i.e. enforce conservation of particle number)</span>
            <span class="n">number_of_1s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">state_label</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">number_of_1s</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># track the total number of shots/probability norm used in computing the expectation value</span>
                <span class="n">norm</span> <span class="o">+=</span> <span class="n">count_val</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">q_j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">state_label</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">q_j</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
                        <span class="n">z_exp_vals</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">count_val</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_exp_vals</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count_val</span>
        <span class="n">z_exp_vals</span> <span class="o">/=</span> <span class="n">norm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">state_label</span><span class="p">,</span> <span class="n">count_val</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Loop through the individual bits of the state and compute the expectation value of Z at each site</span>
            <span class="n">norm</span> <span class="o">+=</span> <span class="n">count_val</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">q_j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">state_label</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">q_j</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
                    <span class="n">z_exp_vals</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">count_val</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_exp_vals</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count_val</span>
        <span class="n">z_exp_vals</span> <span class="o">/=</span> <span class="n">norm</span>

    <span class="c1"># Compute the expectation value of the number operators</span>
    <span class="n">occupation</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">z_exp_vals</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">occupation</span><span class="p">,</span> <span class="n">norm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">occupation</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importing standard Qiskit modules</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">IBMQ</span><span class="p">,</span>
    <span class="n">QuantumCircuit</span><span class="p">,</span>
    <span class="n">QuantumRegister</span><span class="p">,</span>
    <span class="n">ClassicalRegister</span><span class="p">,</span>
    <span class="n">execute</span><span class="p">,</span>
    <span class="n">transpile</span><span class="p">,</span>
    <span class="n">schedule</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="n">QasmSimulator</span>
<span class="kn">from</span> <span class="nn">qiskit.tools.monitor</span> <span class="kn">import</span> <span class="n">job_monitor</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">Parameter</span>

<span class="kn">from</span> <span class="nn">qiskit.providers.fake_provider</span> <span class="kn">import</span> <span class="n">FakeLagos</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">schedule</span>

<span class="c1"># suppress warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Access-backends-and-their-info">
<h3>Access backends and their info<a class="headerlink" href="#Access-backends-and-their-info" title="Permalink to this heading">¶</a></h3>
<p>We will work with the ibm_lagos device. To estimate circuit performance and other information, lagos’s properties, configuration, defaults, and native gate set can be accessed. In the paper, we accessed the real backend. For ease of access, we’ll implement everything with a simulator that emulates ibm_lagos’s noise profile.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load IBMQ Account data</span>

<span class="c1"># IBMQ.save_account(TOKEN, overwrite=True)  # replace TOKEN with your API token string (https://quantum-computing.ibm.com/lab/docs/iql/manage/account/ibmq)</span>
<span class="c1"># provider = IBMQ.load_account()</span>

<span class="c1"># Get backend for experiment</span>
<span class="c1"># Fill in the hub-group-project for your account</span>
<span class="c1"># provider = IBMQ.get_provider(hub=&quot;your-hub&quot;, group=&quot;your-group&quot;, project=&quot;your-project&quot;)</span>

<span class="c1"># Real backend</span>
<span class="c1"># backend = provider.get_backend(&quot;ibm_lagos&quot;)</span>

<span class="c1"># Simulated backend based on ibmq_lagos&#39;s device noise profile</span>
<span class="c1"># Use the line below for the latest error model. See: https://qiskit.org/documentation/apidoc/providers_fake_provider.html</span>
<span class="c1"># sim_noisy_lagos = QasmSimulator.from_backend(provider.get_backend(&#39;ibm_lagos&#39;))</span>
<span class="c1"># A providerless noisy simulator, but may have an out-of-date noise model</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">FakeLagos</span><span class="p">()</span>

<span class="c1"># Noiseless simulated backend for debugging</span>
<span class="c1"># backend = QasmSimulator()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get useful information about backend (used later on)</span>
<span class="n">properties</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span>
<span class="n">defaults</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">defaults</span><span class="p">()</span>

<span class="c1"># Get native basis gates for backend</span>
<span class="n">basis_gates</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">basis_gates</span>

<span class="c1"># Compute average SX gate error for backend</span>
<span class="n">avg_sx_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">properties</span><span class="o">.</span><span class="n">gate_error</span><span class="p">(</span><span class="s2">&quot;sx&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)])</span>
<span class="c1"># Compute average X gate error for backend</span>
<span class="n">avg_x_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">properties</span><span class="o">.</span><span class="n">gate_error</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)])</span>
<span class="c1"># Compute the average CNOT gate error for backend</span>
<span class="n">avg_cx_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
    <span class="p">[</span><span class="n">properties</span><span class="o">.</span><span class="n">gate_error</span><span class="p">(</span><span class="s2">&quot;cx&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">coupling_map</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Display gate error averages</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average CX gate error: </span><span class="si">{</span><span class="n">avg_cx_err</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average single qubit SX gate error: </span><span class="si">{</span><span class="n">avg_sx_err</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average single qubit X gate error: </span><span class="si">{</span><span class="n">avg_x_err</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average CX gate error: 0.00772
Average single qubit SX gate error: 0.00026
Average single qubit X gate error: 0.00026
</pre></div></div>
</div>
</section>
<section id="Generate-quantum-circuits-for-trotterized-quantum-simulation">
<h3>Generate quantum circuits for trotterized quantum simulation<a class="headerlink" href="#Generate-quantum-circuits-for-trotterized-quantum-simulation" title="Permalink to this heading">¶</a></h3>
<p>Qiskit has functionality to directly <a class="reference external" href="https://qiskit.org/documentation/tutorials/operators/01_operator_flow.html#Part-IV:-Converters">convert opflow objects into quantum circuits</a>. This means we can use the U_trot method we made earlier to compute the unitary time evolution operator and then have it directly converted to a quantum circuit. Below, we’ll use those functions defined earlier in the section.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of trotter steps</span>
<span class="n">trotter_steps</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Generate the trotterized quantum circuit</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">gen_trott_qc</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_35_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_35_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluate parameterized circuit over the range of time values used in the previous cells</span>
<span class="n">qcs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Bind parameters for each step in time series</span>
<span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
    <span class="n">qcs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">time_param</span><span class="p">:</span> <span class="n">time</span><span class="p">}))</span>

<span class="n">qcs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 50/50 [00:00&lt;00:00, 1560.82it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_36_1.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_36_1.png" />
</div>
</div>
</section>
<section id="Quantify-improvement-from-transpiler-passes">
<h3>Quantify improvement from transpiler passes<a class="headerlink" href="#Quantify-improvement-from-transpiler-passes" title="Permalink to this heading">¶</a></h3>
<p>Using the transpiler, we can reduce the total number of gates and duration of the circuit. This in turn reduces the total error in the quantum computation. Here we only show using the <code class="docutils literal notranslate"><span class="pre">optimization_level</span></code> argument. In later sections, we will demonstrate the exact transpiler passes that reduce the circuits. See the <a class="reference external" href="https://arxiv.org/abs/2209.02795">paper</a> for details on the heuristic we use to estimate circuit fidelity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check number of gate counts at the second to last time step</span>

<span class="c1"># Although we are transpiling here, the optimization_level=0 means it is only changing gates to be in the native gate set of ibm_lagos</span>
<span class="n">qc_ops</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qcs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit gate counts:&quot;</span><span class="p">,</span> <span class="n">qc_ops</span><span class="p">)</span>
<span class="c1"># Check circuit reduction from transpiler at its highest optimization_level allows for heavy modifcation and reduction of the circuit</span>
<span class="n">qc_t_ops</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qcs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transpiled circuit gate counts:&quot;</span><span class="p">,</span> <span class="n">qc_t_ops</span><span class="p">)</span>

<span class="c1"># Display various fidelity values between two circuits</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Circuit gate error estimate ---&quot;</span><span class="p">)</span>
<span class="n">cx_fid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">avg_cx_err</span><span class="p">)</span> <span class="o">**</span> <span class="n">qc_ops</span><span class="p">[</span><span class="s2">&quot;cx&quot;</span><span class="p">]</span>
<span class="n">sx_fid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">avg_sx_err</span><span class="p">)</span> <span class="o">**</span> <span class="n">qc_ops</span><span class="p">[</span><span class="s2">&quot;sx&quot;</span><span class="p">]</span>
<span class="n">total_fid</span> <span class="o">=</span> <span class="n">cx_fid</span> <span class="o">*</span> <span class="n">sx_fid</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CX gate error contribution: </span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cx_fid</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SX gate error contribution: </span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx_fid</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total circuit fidelity: </span><span class="si">{</span><span class="n">total_fid</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Transpiled circuit gate error estimate ---&quot;</span><span class="p">)</span>
<span class="n">cx_t_fid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">avg_cx_err</span><span class="p">)</span> <span class="o">**</span> <span class="n">qc_t_ops</span><span class="p">[</span><span class="s2">&quot;cx&quot;</span><span class="p">]</span>
<span class="n">sx_t_fid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">avg_sx_err</span><span class="p">)</span> <span class="o">**</span> <span class="n">qc_t_ops</span><span class="p">[</span><span class="s2">&quot;sx&quot;</span><span class="p">]</span>
<span class="n">total_t_fid</span> <span class="o">=</span> <span class="n">cx_t_fid</span> <span class="o">*</span> <span class="n">sx_t_fid</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CX gate error contribution: </span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cx_t_fid</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SX gate error contribution: </span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx_t_fid</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total circuit fidelity: </span><span class="si">{</span><span class="n">total_t_fid</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Circuit gate counts: OrderedDict([(&#39;rz&#39;, 91), (&#39;sx&#39;, 50), (&#39;cx&#39;, 16), (&#39;measure&#39;, 5)])
Transpiled circuit gate counts: OrderedDict([(&#39;rz&#39;, 30), (&#39;sx&#39;, 20), (&#39;cx&#39;, 8), (&#39;measure&#39;, 5), (&#39;x&#39;, 2)])

--- Circuit gate error estimate ---
CX gate error contribution: 0.1166
SX gate error contribution: 0.0128
Total circuit fidelity: 0.8721

--- Transpiled circuit gate error estimate ---
CX gate error contribution: 0.0601
SX gate error contribution: 0.0051
Total circuit fidelity: 0.9350
</pre></div></div>
</div>
</section>
<section id="Estimate-circuit-error-and-circuit-duration-vs-number-of-trotter-steps-(transpiler-optimization)">
<h3>Estimate circuit error and circuit duration vs number of trotter steps (transpiler optimization)<a class="headerlink" href="#Estimate-circuit-error-and-circuit-duration-vs-number-of-trotter-steps-(transpiler-optimization)" title="Permalink to this heading">¶</a></h3>
<p>Let’s expand the circuit fidelity analysis we did in the above section to a range of trotter steps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_circuit_gate_fidelity</span><span class="p">(</span>
    <span class="n">num_two_q_gates</span><span class="p">,</span> <span class="n">num_single_q_gates</span><span class="p">,</span> <span class="n">ave_two_q_gate_fid</span><span class="p">,</span> <span class="n">ave_single_q_fid</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate the fidelity of the combined two-qubit and single-qubit gates in a circuit.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_two_q_gates - int; the number of two-qubit gates. Assumes the same two-qubit gate is used throughout the circuit.</span>
<span class="sd">        num_single_q_gates - int; the number of single-qubit gates. Assumes the same single-qubit gate is used throughout the circuit</span>
<span class="sd">        ave_two_q_gate_fid - float; the average fidelity of the two-qubit gate</span>
<span class="sd">        ave_single_q_fit - float; the average fidelity of the single-qubit gate</span>

<span class="sd">    Returns:</span>
<span class="sd">        fidelity - float; estimated fidelity of circuit operations (see paper for details)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">ave_two_q_gate_fid</span><span class="o">**</span><span class="n">num_two_q_gates</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">ave_single_q_fid</span><span class="o">**</span><span class="n">num_single_q_gates</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaulate all circuits at the final time evolution time</span>
<span class="n">t_final</span> <span class="o">=</span> <span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Number of trotter steps</span>
<span class="n">trotter_steps_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

<span class="c1"># Empty list to store untranspiled (&quot;digital&quot;) circuits</span>
<span class="n">qcs_digital</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Empty list to store heavily transpiled circuits</span>
<span class="n">qcs_transpiled</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Empty list to store estimate of quantum circuit fidelities of 2 cases</span>
<span class="n">qc_d_fid_ests</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">qc_t_fid_ests</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Empty list to store estimate of quantum duration of 2 cases</span>
<span class="n">qc_d_dur_ests</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">qc_t_dur_ests</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">trotter_steps</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">trotter_steps_array</span><span class="p">):</span>
    <span class="c1"># Generate Trotterized evolution circuit</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">gen_trott_qc</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>

    <span class="c1"># Bind time and Hamiltonian parameters</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">qc</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">time_param</span><span class="p">:</span> <span class="n">t_final</span><span class="p">})</span>

    <span class="c1"># Estimate circuit gate error and circuit duration for an unoptimized circuit (&quot;digital&quot;)</span>
    <span class="n">qc_digital</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># get the number of each type of gate in the circuit</span>
    <span class="n">qc_d_ops</span> <span class="o">=</span> <span class="n">qc_digital</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()</span>
    <span class="n">fid_d</span> <span class="o">=</span> <span class="n">compute_circuit_gate_fidelity</span><span class="p">(</span>
        <span class="n">qc_d_ops</span><span class="p">[</span><span class="s2">&quot;cx&quot;</span><span class="p">],</span> <span class="n">qc_d_ops</span><span class="p">[</span><span class="s2">&quot;sx&quot;</span><span class="p">],</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">avg_cx_err</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">avg_sx_err</span>
    <span class="p">)</span>
    <span class="n">qc_d_fid_ests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fid_d</span><span class="p">)</span>  <span class="c1"># store fidelity estimate</span>

    <span class="c1"># Estimate how long the circuit will take to execute on the superconducting qubits</span>
    <span class="c1"># config.dt is in units of seconds</span>
    <span class="c1"># backend must be FakeLagos or the real ibmq_lagos backend</span>
    <span class="n">qc_d_dur</span> <span class="o">=</span> <span class="n">schedule</span><span class="p">(</span><span class="n">qc_digital</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span><span class="o">.</span><span class="n">duration</span> <span class="o">*</span> <span class="n">config</span><span class="o">.</span><span class="n">dt</span>
    <span class="n">qc_d_dur_ests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qc_d_dur</span><span class="p">)</span>  <span class="c1"># store duration estimate</span>

    <span class="c1"># Estimate circuit gate error and circuit duration for a heavily transpiled circuit (&quot;transpiled&quot;)</span>
    <span class="n">qc_transpiled</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># get the number of each type of gate in the circuit</span>
    <span class="n">qc_t_ops</span> <span class="o">=</span> <span class="n">qc_transpiled</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()</span>
    <span class="n">fid_t</span> <span class="o">=</span> <span class="n">compute_circuit_gate_fidelity</span><span class="p">(</span>
        <span class="n">qc_t_ops</span><span class="p">[</span><span class="s2">&quot;cx&quot;</span><span class="p">],</span> <span class="n">qc_t_ops</span><span class="p">[</span><span class="s2">&quot;sx&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">qc_t_ops</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">avg_cx_err</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">avg_sx_err</span>
    <span class="p">)</span>
    <span class="n">qc_t_fid_ests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fid_t</span><span class="p">)</span>  <span class="c1"># store fidelity estimate</span>

    <span class="c1"># Estimate how long the circuit will take to execute on the superconducting qubits</span>
    <span class="c1"># config.dt is in units of seconds</span>
    <span class="n">qc_t_dur</span> <span class="o">=</span> <span class="n">schedule</span><span class="p">(</span><span class="n">qc_transpiled</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span><span class="o">.</span><span class="n">duration</span> <span class="o">*</span> <span class="n">config</span><span class="o">.</span><span class="n">dt</span>
    <span class="n">qc_t_dur_ests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qc_t_dur</span><span class="p">)</span>  <span class="c1"># store duration estimate</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 12/12 [00:22&lt;00:00,  1.86s/it]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot estimated circuit fidelity vs number of trotter steps</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">qc_d_fid_ests</span><span class="p">,</span>
    <span class="s2">&quot;k-o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No optimization&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">qc_t_fid_ests</span><span class="p">,</span>
    <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Transpiled&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumpurple&quot;</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Trotter steps&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fidelity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">trotter_steps_array</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Estimated circuit fidelity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_42_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_42_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot circuit runtime vs number of trotter steps</span>
<span class="c1"># Convert duractions to microseconds for plot</span>
<span class="n">qc_d_dur_ests_us</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qc_d_dur_ests</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span>
<span class="n">qc_t_dur_ests_us</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qc_t_dur_ests</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">qc_d_dur_ests_us</span><span class="p">,</span>
    <span class="s2">&quot;k-o&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No optimization&quot;</span><span class="p">,</span>
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">qc_t_dur_ests_us</span><span class="p">,</span>
    <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumpurple&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Transpiled&quot;</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Trotter steps&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Time ($\mu$s)&quot;</span><span class="p">)</span>
<span class="c1"># plt.ylim([0, 20e4])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">trotter_steps_array</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Estimated circuit execution duration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_43_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_43_0.png" />
</div>
</div>
</section>
<section id="Only-mitigating-by-transpilation">
<h3>Only mitigating by transpilation<a class="headerlink" href="#Only-mitigating-by-transpilation" title="Permalink to this heading">¶</a></h3>
<p>Just using the transpiler can dramatically improve quantum circuits (as seen in the plots above), but it’s not that only way, nor will it always be the most effective. It is ultimately a black box optimization. Diving more deeply into the hardware and considering more about what error mitigation might be most useful, we can get even better results. Let’s demonstrate this by running the transpiled circuit on the ibm_lagos now and compare it to when we combine many error mitigation techniques.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of trotter steps</span>
<span class="n">trotter_steps</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># Generate Trotterized evolution circuit</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">gen_trott_qc</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>

<span class="c1"># Blindly use the transpiler</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Evaluate parameterized circuit over the range of time values used in the previous cells</span>
<span class="n">qcs_8_ts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Bind parameters for each step in time series</span>
<span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
    <span class="c1"># Confirm all gates are optimized a 2nd time after binding parameters</span>
    <span class="n">qc_eval</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">time_param</span><span class="p">:</span> <span class="n">time</span><span class="p">}),</span>
        <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">,</span>
        <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">qcs_8_ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qc_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 50/50 [00:21&lt;00:00,  2.31it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="c1"># backend = sim</span>
<span class="c1"># backend = sim_noisy_lagos</span>
<span class="c1"># backend = lagos</span>

<span class="c1"># Execute list of quantum circuits</span>
<span class="n">job_8_ts_sim</span> <span class="o">=</span> <span class="n">execute_qcs</span><span class="p">(</span><span class="n">qcs_8_ts</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job ID 477ab246-6f6c-491c-baf6-487c9fd91c45
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access old job if needed.</span>
<span class="c1"># jod_8_steps = &#39;62e9204337e42fc816aed24d&#39;</span>
<span class="c1"># jod_8_steps = &#39;63286d880cfeefc4de7dc48f&#39;</span>
<span class="c1"># jod_8_steps = &#39;632bb5e1fcf0f30db3eacb6f&#39;</span>
<span class="c1"># job_old = lagos.retrieve_job(jod_8_steps)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">job_8_ts_sim</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert counts to expectation value of the number operator at each site</span>
<span class="n">num_op_matrix_tran_8_ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)):</span>
    <span class="c1"># Choose to use unmitigated counts here</span>
    <span class="n">num_op_matrix_tran_8_ts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">dict_to_num_op_ex_val</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Note that the data shown below are from the simulator FakeLagos(), and are not as noisy as a real backend. See the paper for plots of data from the real backend ibm_lagos, or rerun the notebook using the real backend.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot state dynamics of a particular site</span>
<span class="n">site</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.25</span><span class="p">,</span> <span class="mf">3.75</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span>
    <span class="n">evo_matrix_trot_8</span><span class="p">[:,</span> <span class="n">site</span><span class="p">],</span>
    <span class="s2">&quot;r-o&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Exact $m=8$&quot;</span><span class="p">,</span>
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;salmon&quot;</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span>
    <span class="n">num_op_matrix_tran_8_ts</span><span class="p">[:,</span> <span class="n">site</span><span class="p">],</span>
    <span class="s2">&quot;b-o&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Measured&quot;</span><span class="p">,</span>
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;royalblue&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;State dynamics on site &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">site</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_51_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_51_0.png" />
</div>
</div>
<p>The dynamics are almost immediately washed out when using the real backend (see paper) even though we use the transpiler to optimize the circuit. Can we do better? Yes! Let’s explore more mitigation techniques and strategies.</p>
</section>
</section>
<section id="Mitigated-Simulation">
<h2>Mitigated Simulation<a class="headerlink" href="#Mitigated-Simulation" title="Permalink to this heading">¶</a></h2>
<section id="Map-o-matic">
<h3>Map-o-matic<a class="headerlink" href="#Map-o-matic" title="Permalink to this heading">¶</a></h3>
<p>We can find additional improvements by picking qubits with the best coherence times and lowest gate errors. The <a class="reference external" href="https://github.com/Qiskit-Partners/mapomatic">map-o-matic</a> tool does just that. In our case, we are using a 7-qubit device, but are only computing on 5 of them. Which 5 qubits do we choose? Based on the couplings of the system we want to simulate, having 5 qubits connected in a line would be the best option. Other configurations would require SWAP gates which come at the expense of
3 CNOT gates each.</p>
<p>There are four unique combinations where five of the seven qubits are in a line. Map-o-matic will calculate which is the best for us. We will store this list of qubits in the list <code class="docutils literal notranslate"><span class="pre">q_regs</span></code> for later use.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mapomatic</span> <span class="k">as</span> <span class="nn">mm</span>

<span class="n">small_qc</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">deflate_circuit</span><span class="p">(</span><span class="n">transpile</span><span class="p">(</span><span class="n">qcs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">best_overall_layout</span><span class="p">(</span><span class="n">small_qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="c1"># Extract the quantum registers from score list</span>
<span class="n">q_regs</span> <span class="o">=</span> <span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;map-o-matic (quantum registers, backend, score):&quot;</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
map-o-matic (quantum registers, backend, score): ([6, 5, 3, 1, 2], &#39;fake_lagos&#39;, 0.1388134054197604)
</pre></div></div>
</div>
</section>
<section id="Measurement-Error-Mitigation">
<h3>Measurement Error Mitigation<a class="headerlink" href="#Measurement-Error-Mitigation" title="Permalink to this heading">¶</a></h3>
<p>We directly follow the <a class="reference external" href="https://qiskit.org/documentation/partners/mthree/basic.html">mthree tutorial</a> for scalable measurement error mitigation. For further examples, see the <a class="reference external" href="https://qiskit.org/textbook/preface.html">Qiskit textbook’s</a> tutorial on <a class="reference external" href="https://qiskit.org/textbook/ch-quantum-hardware/measurement-error-mitigation.html#version-information">measurement error mitigation</a>. Below, we first demonstrate this technique on a simple example of a GHZ state
<span class="math notranslate nohighlight">\(\left(|00000\rangle + |11111\rangle \right)/ \sqrt{2}\)</span>. We will use it for the quantum simulation at the very end.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mthree</span>

<span class="c1"># This submits jobs to the queue when using real backends</span>
<span class="n">mit</span> <span class="o">=</span> <span class="n">mthree</span><span class="o">.</span><span class="n">M3Mitigation</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="n">mit</span><span class="o">.</span><span class="n">cals_from_system</span><span class="p">(</span><span class="n">q_regs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The M3 mitigator is now ready to go. We’ll now apply it to preparing a GHZ state over 5 qubits.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize quantum circuit</span>
<span class="n">qrs</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># working with lagos</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">qrs</span><span class="p">)</span>

<span class="c1"># Generate the GHZ state: (|00000&gt; + \11111&gt;) / Sqrt[2]</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q_regs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q_regs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q_regs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q_regs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q_regs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q_regs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">q_regs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q_regs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">q_regs</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

<span class="n">qc</span><span class="o">.</span><span class="n">measure_active</span><span class="p">()</span>

<span class="n">qc</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_57_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_57_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="c1"># backend = sim</span>
<span class="c1"># backend = sim_noisy_lagos</span>
<span class="c1"># backend = lagos</span>

<span class="c1"># Execute list of quantum circuits</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">execute_qcs</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job ID 27a87a9d-a585-4e99-83f3-b4c539129e88
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get qc results and counts</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">noisy_counts</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><strong>Note that the data shown below are from the simulator FakeLagos(), and are not as noisy as a real backend. See the paper for plots of data from the real backend ibm_lagos, or rerun the notebook using the real backend.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.visualization</span> <span class="kn">import</span> <span class="n">plot_histogram</span>

<span class="c1"># Get qc results and counts</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">noisy_counts</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>

<span class="c1"># Apply measurement error mitigation post-processing</span>
<span class="n">mitigated_probs</span> <span class="o">=</span> <span class="n">mit</span><span class="o">.</span><span class="n">apply_correction</span><span class="p">(</span><span class="n">noisy_counts</span><span class="p">,</span> <span class="n">q_regs</span><span class="p">)</span>

<span class="c1"># Calculation probabilities between no measurement error mitigation and some</span>
<span class="n">noisy_p0s</span> <span class="o">=</span> <span class="n">noisy_counts</span><span class="p">[</span><span class="s2">&quot;00000&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">shots</span>
<span class="n">noisy_p1s</span> <span class="o">=</span> <span class="n">noisy_counts</span><span class="p">[</span><span class="s2">&quot;11111&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">shots</span>
<span class="n">mit_p0s</span> <span class="o">=</span> <span class="n">mitigated_probs</span><span class="p">[</span><span class="s2">&quot;00000&quot;</span><span class="p">]</span>
<span class="n">mit_p1s</span> <span class="o">=</span> <span class="n">mitigated_probs</span><span class="p">[</span><span class="s2">&quot;11111&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expected 50% +/-&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">shots</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f |00000&gt; and |11111&gt;&quot;</span><span class="p">)</span>

<span class="c1"># Compare before and after measurement error mitigation</span>
<span class="n">plot_histogram</span><span class="p">([</span><span class="n">noisy_counts</span><span class="p">,</span> <span class="n">mitigated_probs</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;noisy&quot;</span><span class="p">,</span> <span class="s2">&quot;mitigated&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Expected 50% +/- 0.5 % of |00000&gt; and |11111&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_61_1.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_61_1.png" />
</div>
</div>
</section>
<section id="R_{ZX}(\theta)-Gate-Optimization">
<h3><span class="math notranslate nohighlight">\(R_{ZX}(\theta)\)</span> Gate Optimization<a class="headerlink" href="#R_{ZX}(\theta)-Gate-Optimization" title="Permalink to this heading">¶</a></h3>
<p>Two-qubit gate errors are the main source of error for current (NISQ era) quantum computers. One way to get a significant reduction in two-qubit errors is to dive closer to the physics of the underlying qubits and use the native two-qubit gates instead of CNOT gates. Read the <a class="reference external" href="https://arxiv.org/abs/2209.02795">paper</a> and references therein for more details. In short, we want to compose all two-qubit gates in terms of <cite>:math:`R_{ZX}(theta)</cite> gate
operations &lt;<a class="reference external" href="https://qiskit.org/documentation/stubs/qiskit.circuit.library.RZXGate.html">https://qiskit.org/documentation/stubs/qiskit.circuit.library.RZXGate.html</a>&gt;`__.</p>
<p>Compose the circuit in terms of <span class="math notranslate nohighlight">\(R_{ZX}(\theta)\)</span> gate operations instead of CNOT gates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.converters</span> <span class="kn">import</span> <span class="n">circuit_to_dag</span><span class="p">,</span> <span class="n">dag_to_circuit</span>


<span class="k">def</span> <span class="nf">estimate_fidelity</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">initial_layout</span><span class="p">,</span> <span class="n">backend</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    New function to estimate of circuit fidelity to account for RZX gates and how they are scaled (theta value relative to pi/2).</span>

<span class="sd">    Assume linear dependence between gate error and RZX angle.</span>

<span class="sd">    Args:</span>
<span class="sd">        circuit - QuantumCircuit; the quantum circuit you want to compute the gate error for.</span>
<span class="sd">        initial_layout - list of ints; quantum register of which qubit are being used in the circuit.</span>
<span class="sd">        backend - IBMQBackend; the specific device the circuit will be executed on.</span>

<span class="sd">    Returns:</span>
<span class="sd">        fidelity - float;  estimated fidelity of circuit with Rzx gate operations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dag</span> <span class="o">=</span> <span class="n">circuit_to_dag</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
    <span class="n">rzx_runs</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">collect_runs</span><span class="p">([</span><span class="s2">&quot;rzx&quot;</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">num_cx</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()[</span><span class="s2">&quot;cx&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">num_cx</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Compute average 2-qubit gate error over the qubits in use</span>
    <span class="n">avg_gate_error</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_layout</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">initial_layout</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">initial_layout</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">avg_gate_error</span> <span class="o">+=</span> <span class="n">backend</span><span class="o">.</span><span class="n">properties</span><span class="p">()</span><span class="o">.</span><span class="n">gate_property</span><span class="p">(</span><span class="s2">&quot;cx&quot;</span><span class="p">)[(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)][</span>
            <span class="s2">&quot;gate_error&quot;</span>
        <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">avg_gate_error</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_layout</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># Get Rzx error</span>
    <span class="n">est_fid_rzx</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">rzx_run</span> <span class="ow">in</span> <span class="n">rzx_runs</span><span class="p">:</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">rzx_run</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">this_rzx_error</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">avg_gate_error</span>
        <span class="n">est_fid_rzx</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">this_rzx_error</span>

    <span class="n">est_fid_rzx</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">avg_gate_error</span><span class="p">)</span> <span class="o">**</span> <span class="n">num_cx</span>

    <span class="c1"># Compute average single qubit gate errors</span>
    <span class="n">ops</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()</span>  <span class="c1"># get the number of each type of gate in the circuit</span>
    <span class="n">est_fid_1q</span> <span class="o">=</span> <span class="n">compute_circuit_gate_fidelity</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span> <span class="n">ops</span><span class="p">[</span><span class="s2">&quot;sx&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">ops</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">avg_sx_err</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">est_fid_1q</span> <span class="o">*</span> <span class="n">est_fid_rzx</span>


<span class="k">def</span> <span class="nf">total_rzx_angle</span><span class="p">(</span><span class="n">circuit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add up the total evolution time (thetas) of the Rzx gates in a given circuit.</span>

<span class="sd">    Useful for quanitfying error and debugging circuits.</span>

<span class="sd">    Args:</span>
<span class="sd">        circuit - QuantumCircuit; the quantum circuit you wish to analyze</span>

<span class="sd">    Returns:</span>
<span class="sd">        total_rzx_angle - float; total amount of angle evolved by all the R_zx gate operations of the circuit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dag</span> <span class="o">=</span> <span class="n">circuit_to_dag</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
    <span class="n">rzx_runs</span> <span class="o">=</span> <span class="n">dag</span><span class="o">.</span><span class="n">collect_runs</span><span class="p">([</span><span class="s2">&quot;rzx&quot;</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">num_cx</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">count_ops</span><span class="p">()[</span><span class="s2">&quot;cx&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">num_cx</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Sum up the absolute value of all the rzx angles</span>
    <span class="n">total_rzx_angle</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Get Rzx error</span>
    <span class="n">est_fid_rzx</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">rzx_run</span> <span class="ow">in</span> <span class="n">rzx_runs</span><span class="p">:</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">rzx_run</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">op</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">total_rzx_angle</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">total_rzx_angle</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpiler passes needed to efficiently convert circuit to RZX gates</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler</span> <span class="kn">import</span> <span class="n">PassManager</span>
<span class="kn">from</span> <span class="nn">qiskit.transpiler.passes</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TemplateOptimization</span><span class="p">,</span>
    <span class="n">Collect2qBlocks</span><span class="p">,</span>
    <span class="n">ConsolidateBlocks</span><span class="p">,</span>
    <span class="n">EchoRZXWeylDecomposition</span><span class="p">,</span>
    <span class="n">Optimize1qGatesDecomposition</span><span class="p">,</span>
    <span class="n">RZXCalibrationBuilderNoEcho</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># PassManager used on circuit with Parameterized time values</span>
<span class="c1"># It combines gates into blocks that act of 2 qubits then decomposes those 2-qubit blocks</span>
<span class="c1"># in terms of Rzx gates using the KAK decomposition</span>
<span class="c1"># Also optimizes single qubit gates.</span>
<span class="n">pm_rzx_param</span> <span class="o">=</span> <span class="n">PassManager</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Collect2qBlocks</span><span class="p">(),</span>
        <span class="n">ConsolidateBlocks</span><span class="p">(</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;rzx&quot;</span><span class="p">]),</span>
        <span class="c1"># Rewrite circuit in terms of Weyl-decomposed echoed RZX gates.</span>
        <span class="n">EchoRZXWeylDecomposition</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">instruction_schedule_map</span><span class="p">),</span>
        <span class="c1"># Reduce the number of single qubit gates</span>
        <span class="n">Optimize1qGatesDecomposition</span><span class="p">(</span><span class="n">basis_gates</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Alternative method using the RZX template optimization</span>
<span class="c1"># # Make the RZX transpiler pass using template optimization</span>
<span class="c1"># pm_rzx_template = PassManager([</span>
<span class="c1">#     # Identify where an RZX gate could replace two CNOTs sandwiching an Rz</span>
<span class="c1">#     TemplateOptimization(**rzx_templates.rzx_templates()),</span>
<span class="c1">#     # Clean up single qubit gates</span>
<span class="c1">#     Optimize1qGatesDecomposition(basis_gates + [&#39;rzx&#39;])</span>
<span class="c1"># ])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of trotter steps</span>
<span class="n">trotter_steps</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Generate Trotterized evolution circuit</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">gen_trott_qc</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>

<span class="c1"># Convert CNOTs to RZX gates</span>
<span class="n">qc_rzx</span> <span class="o">=</span> <span class="n">pm_rzx_param</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit operations:&quot;</span><span class="p">,</span> <span class="n">qc_rzx</span><span class="o">.</span><span class="n">count_ops</span><span class="p">())</span>
<span class="n">qc_rzx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Circuit operations: OrderedDict([(&#39;rz&#39;, 88), (&#39;sx&#39;, 46), (&#39;rzx&#39;, 32), (&#39;x&#39;, 23), (&#39;measure&#39;, 5)])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_66_1.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_66_1.png" />
</div>
</div>
<p>Notice how the <span class="math notranslate nohighlight">\(R_{ZX}\)</span> gates all have the same angle <span class="math notranslate nohighlight">\(\pi/4\)</span> and that it’s some of the <span class="math notranslate nohighlight">\(R_Z\)</span> gates that have the parameter <span class="math notranslate nohighlight">\(t\)</span> in their arguments. This is not what we want. We want the angle of the <span class="math notranslate nohighlight">\(R_{ZX}\)</span> gates to change as a function of time, not the <span class="math notranslate nohighlight">\(R_Z\)</span> gates. We will need to evaluate the circuits <span class="math notranslate nohighlight">\(t\)</span> Parameter first to get this behavior.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply transpiler passes that gives Rzx gates a scaled pulse schedule and optimized single qubit gates</span>
<span class="n">inst_sched_map</span> <span class="o">=</span> <span class="n">defaults</span><span class="o">.</span><span class="n">instruction_schedule_map</span>
<span class="n">channel_map</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">qubit_channel_mapping</span>
<span class="n">pm_rzx_cal</span> <span class="o">=</span> <span class="n">PassManager</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Collect2qBlocks</span><span class="p">(),</span>
        <span class="n">ConsolidateBlocks</span><span class="p">(</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;rzx&quot;</span><span class="p">]),</span>
        <span class="n">EchoRZXWeylDecomposition</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">instruction_schedule_map</span><span class="p">),</span>
        <span class="c1"># Scale Rzx gates to the desired angle</span>
        <span class="n">RZXCalibrationBuilderNoEcho</span><span class="p">(</span><span class="n">inst_sched_map</span><span class="p">,</span> <span class="n">channel_map</span><span class="p">),</span>
        <span class="n">Optimize1qGatesDecomposition</span><span class="p">(</span><span class="n">basis_gates</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;rzx&quot;</span><span class="p">]),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Number of trotter steps</span>
<span class="n">trotter_steps</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># Generate Trotterized evolution circuit</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">gen_trott_qc</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>

<span class="c1"># Empty list to store quantum circuits for each time point</span>
<span class="n">qcs_rzx</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Empty list fto store the fidelity of each circuit</span>
<span class="n">rzx_fids</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Bind parameters for each step in time series THEN conver to RZX gates and add RZX schedule making each RZX gate a &quot;pulsed gated&quot;</span>
<span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
    <span class="n">qc_t</span> <span class="o">=</span> <span class="n">qc</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">time_param</span><span class="p">:</span> <span class="n">time</span><span class="p">})</span>

    <span class="c1"># Apply transpiler passes that gives Rzx gates a pulse schedule and optimized single qubit gates</span>
    <span class="n">qc_t</span> <span class="o">=</span> <span class="n">pm_rzx_cal</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc_t</span><span class="p">)</span>

    <span class="n">qcs_rzx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qc_t</span><span class="p">)</span>
    <span class="n">rzx_fids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">estimate_fidelity</span><span class="p">(</span><span class="n">qc_t</span><span class="p">,</span> <span class="n">q_regs</span><span class="p">,</span> <span class="n">backend</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 50/50 [00:26&lt;00:00,  1.89it/s]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># qcs_rzx[-2].draw(&#39;mpl&#39;)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Circuit fidelity comparison</span>
<span class="c1"># the 0th index is the circuit with 1 trotter step</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Circuit fidelity: </span><span class="si">{</span><span class="n">qc_d_fid_ests</span><span class="p">[</span><span class="n">trotter_steps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># the 0th index is the circuit with 1 trotter step</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transpiled circuit fidelity: </span><span class="si">{</span><span class="n">qc_t_fid_ests</span><span class="p">[</span><span class="n">trotter_steps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RZX circuit fidelity: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rzx_fids</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Circuit fidelity: 0.3357
Transpiled circuit fidelity: 0.5948
RZX circuit fidelity: 0.8031
</pre></div></div>
</div>
</section>
<section id="Estimate-circuit-error-and-circuit-duration-vs-number-of-trotter-steps-(RZX-optimization)">
<h3>Estimate circuit error and circuit duration vs number of trotter steps (RZX optimization)<a class="headerlink" href="#Estimate-circuit-error-and-circuit-duration-vs-number-of-trotter-steps-(RZX-optimization)" title="Permalink to this heading">¶</a></h3>
<p>Let’s expand this analysis to a range of trotter steps. The <span class="math notranslate nohighlight">\(R_{ZX}\)</span> optimized circuits will have a varying fidelity for different time points because different time points share a different amount of <span class="math notranslate nohighlight">\(R_{ZX}\)</span> evolution. We will average over those effects.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaulate all circuits over all time points and take the mean</span>

<span class="c1"># Compute parameterized circuit over a range of trotter steps</span>
<span class="n">trotter_steps_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

<span class="c1"># Empty list to store estimate of quantum circuit fidelity</span>
<span class="n">qc_rzx_fid_ests</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Empty list to store estimate of quantum duration</span>
<span class="n">qc_rzx_dur_ests</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Empty list to store final quantum circuits</span>
<span class="n">qcs_rzx_trotter_steps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">trotter_steps</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">trotter_steps_array</span><span class="p">):</span>
    <span class="c1"># Generate Trotterized evolution circuit</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">gen_trott_qc</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">time_param</span><span class="p">,</span> <span class="n">trotter_steps</span><span class="p">)</span>

    <span class="c1"># Bind time value and Hamiltonian parameters</span>
    <span class="c1"># Empty list to store circuit fidelities over the range of time points (later averaged over)</span>
    <span class="n">rzx_fids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Empty list to store circuit durations over the range of time points (later averaged over)</span>
    <span class="n">qc_dur</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rzx_angles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
        <span class="n">qc_t</span> <span class="o">=</span> <span class="n">qc</span><span class="o">.</span><span class="n">bind_parameters</span><span class="p">({</span><span class="n">time_param</span><span class="p">:</span> <span class="n">time</span><span class="p">})</span>

        <span class="c1"># Apply transpiler passes that gives Rzx gates a pulse schedule and optimized single qubit gates</span>
        <span class="n">qc_t</span> <span class="o">=</span> <span class="n">pm_rzx_cal</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc_t</span><span class="p">)</span>

        <span class="c1"># Store circuit, fidelity estimate, and duration estimate</span>
        <span class="n">qcs_rzx_trotter_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qc_t</span><span class="p">)</span>
        <span class="n">rzx_fids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">estimate_fidelity</span><span class="p">(</span><span class="n">qc_t</span><span class="p">,</span> <span class="n">q_regs</span><span class="p">,</span> <span class="n">backend</span><span class="p">))</span>
        <span class="n">qc_dur</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">schedule</span><span class="p">(</span><span class="n">qc_t</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span><span class="o">.</span><span class="n">duration</span> <span class="o">*</span> <span class="n">config</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">rzx_angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_rzx_angle</span><span class="p">(</span><span class="n">qc_t</span><span class="p">))</span>

    <span class="c1"># Calculate average fidelity for a given trotter step</span>
    <span class="n">qc_rzx_fid_ests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rzx_fids</span><span class="p">))</span>

    <span class="c1"># Calculate average duration for a given trotter step</span>
    <span class="n">qc_rzx_dur_ests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">qc_dur</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 12/12 [08:57&lt;00:00, 44.83s/it]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">qc_d_fid_ests</span><span class="p">,</span>
    <span class="s2">&quot;k-o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No optimization&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">qc_t_fid_ests</span><span class="p">,</span>
    <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Transpiled&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumpurple&quot;</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">qc_rzx_fid_ests</span><span class="p">,</span>
    <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$R_</span><span class="si">{ZX}</span><span class="s2">$ optimization&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Trotter steps&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fidelity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">trotter_steps_array</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Estimated circuit fidelity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;One trotter step fidelities&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;no opt: </span><span class="si">{</span><span class="n">qc_d_fid_ests</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;transpiled: </span><span class="si">{</span><span class="n">qc_t_fid_ests</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;rzx opt: </span><span class="si">{</span><span class="n">qc_rzx_fid_ests</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Ten trotter step fidelities&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;no opt: </span><span class="si">{</span><span class="n">qc_d_fid_ests</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;transpiled: </span><span class="si">{</span><span class="n">qc_t_fid_ests</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;rzx opt: </span><span class="si">{</span><span class="n">qc_rzx_fid_ests</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_73_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_73_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
One trotter step fidelities no opt: 0.8721 transpiled: 0.9346 rzx opt: 0.9687
Ten trotter step fidelities no opt: 0.2556 transpiled: 0.5228 rzx opt: 0.7924
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qc_d_dur_ests</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
    <span class="s2">&quot;k-o&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No optimization&quot;</span><span class="p">,</span>
    <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qc_t_dur_ests</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
    <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumpurple&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Transpiled&quot;</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">trotter_steps_array</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qc_rzx_dur_ests</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
    <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$R_</span><span class="si">{ZX}</span><span class="s2">$ optimization&quot;</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Trotter steps&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Time ($\mu$s)&quot;</span><span class="p">)</span>
<span class="c1"># plt.ylim([0, 20e4])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">trotter_steps_array</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Estimated circuit execution duration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_74_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_74_0.png" />
</div>
</div>
</section>
</section>
<section id="Execute-Quantum-Simulation-with-Combined-Techniques">
<h2>Execute Quantum Simulation with Combined Techniques<a class="headerlink" href="#Execute-Quantum-Simulation-with-Combined-Techniques" title="Permalink to this heading">¶</a></h2>
<p>Bring map-o-matic, measurement error mitigation, <span class="math notranslate nohighlight">\(R_{ZX}\)</span> gates, and particle conservation (more on that later) together and simulate the state dynamics! (This requires the upper sections to be executed.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="c1"># backend = sim</span>
<span class="c1"># backend = sim_noisy_lagos</span>
<span class="c1"># backend = lagos</span>

<span class="c1"># Execute list of quantum circuits</span>
<span class="n">job_rzx</span> <span class="o">=</span> <span class="n">execute_qcs</span><span class="p">(</span><span class="n">qcs_rzx</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Job ID 4d2c4dac-238b-48e9-8941-771a69219603
Job Status: job has successfully run
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save previous job ids to get access later, if needed.</span>
<span class="c1"># job_id_8_steps = &#39;62b1326c00686284a508a274&#39;</span>
<span class="c1"># job_id_8_steps = &#39;62e9c49b3e2c28cce3bd55cd&#39;</span>
<span class="c1"># job_id_8_steps = &#39;632ba7ca05c8fd41299006d0&#39;</span>

<span class="c1"># job_old = lagos.retrieve_job(job_id_8_steps)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get count from quantum computer</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">job_rzx</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>

<span class="c1"># Apply measurement error mitigation post-processing</span>
<span class="n">mit_probs</span> <span class="o">=</span> <span class="n">mit</span><span class="o">.</span><span class="n">apply_correction</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">q_regs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert counts to expectation value of the number operator at each site</span>
<span class="n">num_op_matrix_rzx_8_ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)):</span>
    <span class="c1"># Choose to use mitigated counts or unmitigated counts in the argument below</span>
    <span class="n">num_op_matrix_rzx_8_ts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">dict_to_num_op_ex_val</span><span class="p">(</span><span class="n">mit_probs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Note that the data shown below are from the simulator FakeLagos(), and are not as noisy as a real backend. See the paper for plots of data from the real backend ibm_lagos, or rerun the notebook using the real backend.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot state dynamics of a particular site</span>
<span class="n">site</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.25</span><span class="p">,</span> <span class="mf">3.75</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span>
    <span class="n">evo_matrix_trot_8</span><span class="p">[:,</span> <span class="n">site</span><span class="p">],</span>
    <span class="s2">&quot;k-.&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Exact ($m=8$)&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span>
    <span class="n">num_op_matrix_tran_8_ts</span><span class="p">[:,</span> <span class="n">site</span><span class="p">],</span>
    <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumpurple&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Transpiled&quot;</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span>
    <span class="n">num_op_matrix_rzx_8_ts</span><span class="p">[:,</span> <span class="n">site</span><span class="p">],</span>
    <span class="s2">&quot;r-o&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Combined&quot;</span><span class="p">,</span>
    <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;State dynamics on site &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">site</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_81_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_81_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot full time evolution in cross sections. Messy but eveything is there.</span>

<span class="n">num_op_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$\langle n_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">rangle$&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_sites</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">evo_matrix_trot</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">num_op_matrix_rzx_8_ts</span><span class="p">,</span> <span class="s2">&quot;-x&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Probability of occupying a given site&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">num_op_labels</span> <span class="o">+</span> <span class="n">num_op_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_quantum_sim_qsim-tight-binding-model_82_0.png" src="../_images/tutorial_quantum_sim_qsim-tight-binding-model_82_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>

<span class="o">%</span><span class="k">qiskit_version_table</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Version Information</h3><table><tr><th>Qiskit Software</th><th>Version</th></tr><tr><td><code>qiskit-terra</code></td><td>0.23.0</td></tr><tr><td><code>qiskit-aer</code></td><td>0.12.2</td></tr><tr><td><code>qiskit-ibmq-provider</code></td><td>0.20.0</td></tr><tr><td><code>qiskit-nature</code></td><td>0.6.0</td></tr><tr><th>System information</th></tr><tr><td>Python version</td><td>3.9.17</td></tr><tr><td>Python compiler</td><td>GCC 11.3.0</td></tr><tr><td>Python build</td><td>main, Jun  7 2023 12:34:12</td></tr><tr><td>OS</td><td>Linux</td></tr><tr><td>CPUs</td><td>2</td></tr><tr><td>Memory (Gb)</td><td>6.7694854736328125</td></tr><tr><td colspan='2'>Tue Aug 01 13:55:49 2023 UTC</td></tr></table></div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"c953a302cfe2430b939134787d202f1d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": "0px 0px 10px 0px", "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8be24a2d0f0b41e6bd342ece9f878b50": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "4912d808b8914d8c9d8b8dae95d9b355": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c953a302cfe2430b939134787d202f1d", "placeholder": "\u200b", "style": "IPY_MODEL_8be24a2d0f0b41e6bd342ece9f878b50", "tabbable": null, "tooltip": null, "value": "<p style='font-family: IBM Plex Sans, Arial, Helvetica, sans-serif; font-size: 20px; font-weight: medium;'>Circuit Properties</p>"}}, "d9bf91200eb841fb973882f4a06496b5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": "right", "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0px 0px 0px 0px", "right": null, "top": null, "visibility": null, "width": "70px"}}, "bb044c0302014b99a8bd41c798b58e60": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "629eec0173614cafa71908d7bdf469de": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "primary", "description": "Clear", "disabled": false, "icon": "", "layout": "IPY_MODEL_d9bf91200eb841fb973882f4a06496b5", "style": "IPY_MODEL_bb044c0302014b99a8bd41c798b58e60", "tabbable": null, "tooltip": null}}, "472ab0cae8ed4b149d9caec001b72e81": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": "\n                                       \". . . . right \"\n                                        ", "grid_template_columns": "20% 20% 20% 20% 20%", "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "3f5dc520748f4b7b853adaef9e6aedaf": {"model_name": "GridBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "GridBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "GridBoxView", "box_style": "", "children": ["IPY_MODEL_629eec0173614cafa71908d7bdf469de"], "layout": "IPY_MODEL_472ab0cae8ed4b149d9caec001b72e81", "tabbable": null, "tooltip": null}}, "740aae1511b94550b2250d59cbec7a37": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "190px"}}, "2d2cb8cd9f884da19eca0ad97a294c25": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "ff302f4eba1e4d89be569c95bd875a5c": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_740aae1511b94550b2250d59cbec7a37", "placeholder": "\u200b", "style": "IPY_MODEL_2d2cb8cd9f884da19eca0ad97a294c25", "tabbable": null, "tooltip": null, "value": "<h5>Job ID</h5>"}}, "e1e23a81947944b4b729589056b3c2b5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "145px"}}, "c0e2fbabbff54dccb0589c48d6b3c28d": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "e15efae42ad946768b54fbfefdd82552": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_e1e23a81947944b4b729589056b3c2b5", "placeholder": "\u200b", "style": "IPY_MODEL_c0e2fbabbff54dccb0589c48d6b3c28d", "tabbable": null, "tooltip": null, "value": "<h5>Backend</h5>"}}, "278dc4e8091e4c3fa8fbcf6d96b49b72": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "95px"}}, "c487698e9d844cd9946da900938039ab": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "ba5020e585454aa9bee83171b3490136": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_278dc4e8091e4c3fa8fbcf6d96b49b72", "placeholder": "\u200b", "style": "IPY_MODEL_c487698e9d844cd9946da900938039ab", "tabbable": null, "tooltip": null, "value": "<h5>Status</h5>"}}, "9600afcbb7ca493590fce4f3514902cf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "70px"}}, "42e2ade53bc24d80965a505ad8ea495d": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "0749373362a64647ad53111d49176fc2": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9600afcbb7ca493590fce4f3514902cf", "placeholder": "\u200b", "style": "IPY_MODEL_42e2ade53bc24d80965a505ad8ea495d", "tabbable": null, "tooltip": null, "value": "<h5>Queue</h5>"}}, "afa92f3cf617470aa811503edd071f1b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bea20b6e49a24c2d91703374bebaf84f": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "e560985801b64ee6ac032390b5726b18": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_afa92f3cf617470aa811503edd071f1b", "placeholder": "\u200b", "style": "IPY_MODEL_bea20b6e49a24c2d91703374bebaf84f", "tabbable": null, "tooltip": null, "value": "<h5>Message</h5>"}}, "a210a0e5bd86472fa3cd17616e693f13": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": "0px 0px 0px 37px", "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "600px"}}, "5cea7b45c16a4bbd92b539bf09016f1e": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_ff302f4eba1e4d89be569c95bd875a5c", "IPY_MODEL_e15efae42ad946768b54fbfefdd82552", "IPY_MODEL_ba5020e585454aa9bee83171b3490136", "IPY_MODEL_0749373362a64647ad53111d49176fc2", "IPY_MODEL_e560985801b64ee6ac032390b5726b18"], "layout": "IPY_MODEL_a210a0e5bd86472fa3cd17616e693f13", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}
</script></section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Qiskit Research</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../mzm_generation/index.html">Majorana zero mode generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protein_folding/index.html">Protein folding</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial on quantum simulation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Quantum Simulation on Noisy Superconducting Quantum Computers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidocs/index.html">Qiskit Research API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Tutorial on quantum simulation</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Tutorial on quantum simulation</a></li>
      <li>Next: <a href="../apidocs/index.html" title="next chapter">Qiskit Research API Reference</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/tutorial_quantum_sim/qsim-tight-binding-model.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>